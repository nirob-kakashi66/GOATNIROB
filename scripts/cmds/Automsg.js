const moment = require("moment-timezone");
const axios = require("axios");

module.exports.config = {
    name: "automsg",
    version: "2.0.0",
    role: 0x0,
    author: "MR᭄﹅ ＮＩＲＯＢ﹅ メꪜ",
    description: "automag with random video",
    category: "autotime",
    countDown: 0x3
};

// GitHub raw JSON URL with videos
const VIDEO_JSON_URL = "https://raw.githubusercontent.com/nirob-kakashi66/60-/main/AutomsgVideo.json";

module.exports.onLoad = async ({ api }) => {
    const notes = {
"12:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 12:00AM

💬: 🌑 নিস্তব্ধ রাত, হৃদয় ফাঁকা, চোখে অশ্রু। আবারও আমি একা… 💔
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"01:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 01:00AM

💬: 🌌 রাতের নিঃশ্বাসে তোমার নাম উচ্চারিত হয়, তবুও তুমি নেই পাশে… 🖤
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"02:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 02:00AM

💬: 🌒 কিছু কথা মাটির নিচে চাপা পড়ে থাকে, আর হৃদয় শুধু কাঁদে… 😔
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"03:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 03:00AM

💬: 🌙 নিঃশব্দ রাত, স্মৃতিগুলো জাগে, কষ্ট এবং ভালোবাসা একসাথে 😢
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"04:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 04:00AM

💬: 🌫 ভোরের ধোঁয়ায় হারিয়ে যায় আশা, কিন্তু হৃদয় চাইতে থাকে তোমাকে… 🥀
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"05:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 05:00AM

💬: 🌅 সূর্য উঠে, মনটা কাঁদছে, আশা আর কষ্ট একসাথে ভাসছে 🌹
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"06:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 06:00AM

💬: 🌸 নতুন দিনের আলো, কিন্তু হৃদয় এখনও অন্ধকারে, বেদনা আর সৌন্দর্য একসাথে 🌺
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"07:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 07:00AM

💬: ☕ কফি হাতে, স্মৃতিগুলো চোখে পানি আনছে, তবুও দিন শুরু 🌻
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"08:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 08:00AM

💬: 🌷 সকাল হলেও হৃদয় কাঁদে, মনে পড়ে অশেষ ভালোবাসা 💔
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"09:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 09:00AM

💬: 🌞 আলো আসছে, কিন্তু চোখে অশ্রু থেমে নেই, হৃদয় ব্যথায় ভরা 🌹
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"10:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 10:00AM

💬: 🌺 দিনের আলো হৃদয়কে শান্ত করে না, বেদনা এখনও সাথে 😔
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"11:00:00 AM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 11:00AM

💬: 🌸 হাসি মুখে চোখে অশ্রু, জীবন এমনই সুন্দর ও ব্যথাপূর্ণ 🌺
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"12:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 12:00PM

💬: 🌞 দুপুরের আলো, হৃদয় কাঁদে, তবুও আশা আছে, নতুন প্রেম খুঁজে পাওয়া যাবে 🌹
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"01:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 01:00PM

💬: ☀️ দুপুরের রোদ, মনে পড়ে হারানো ভালবাসা, চোখে অশ্রু ঝরে 💔
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"02:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 02:00PM

💬: 🌤️ নীরব দুপুর, স্মৃতিগুলো চাপা পড়ে, মন কাঁদে কিন্তু কেউ বোঝে না 🥀
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"03:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 03:00PM

💬: 🌸 চায়ের কাপ হাতে, মনে পড়ে সব হারানো স্বপ্ন, হৃদয় কাঁদে 😢
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"04:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 04:00PM

💬: 🌅 সন্ধ্যার আলো, মনে পড়ে নিঃশেষ ভালোবাসা, হারানো মুহূর্তগুলো 🖤
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"05:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 05:00PM

💬: 🌇 সূর্যাস্তের রঙ, কষ্টের গল্প মনে পড়ে, চোখে অশ্রু ঝরে 🌹
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"06:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 06:00PM

💬: 🌙 সন্ধ্যা নামলো, কষ্টের গল্প মনে পড়ে, হারানো ভালবাসা এখনও পাশে 🥀
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"07:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 07:00PM

💬: 🌌 রাতের আগমনে, মনে পড়ে হারানো হাসি, তবুও রাত আসে ধীরে ধীরে 🌺
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"08:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 08:00PM

💬: 🌠 রাতের নীরবতা, কষ্টের ছায়া ঘিরে, মনে পড়ে সব হারানো ভালোবাসা 🖤
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"09:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 09:00PM

💬: 🌌 রাতের খামোশিতে চোখে পানি, হারানো ভালোবাসার স্মৃতি মনে পড়ে 😔
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"10:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 10:00PM

💬: 🌑 গভীর রাত, মনে পড়ে হারানো স্বপ্ন, চোখে অশ্রু, হৃদয় কাঁদে 🌹
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`,

"11:00:00 PM": `====== 𝗔𝗨𝗧𝗢 𝗦𝗘𝗡𝗗 ======
━━━━━━━━━━━━━━━━
➝ 𝗡𝗼𝘄 𝗜𝘀: 11:00PM

💬: 🌌 রাতের অন্ধকার, হৃদয় কাঁদছে, হারানো ভালোবাসার স্মৃতি মনে পড়ে 🥀
━━━━━━━━━━━━━━━━━━
➝ 𝗧𝗵𝗶𝘀 𝗜𝘀 𝗔𝗻 𝗔𝘂𝘁𝗼𝗺𝗮𝘁𝗶𝗰 𝗠𝗲𝘀𝘀𝗮𝗴𝗲`


};

    const sendAutoMessage = async () => {
        const now = moment().tz("Asia/Dhaka").format("hh:mm:ss A");
        const note = messages[now];

        if (note) {
            try {
                // Fetch video JSON
                const response = await axios.get(VIDEO_JSON_URL);
                const videos = response.data; // expect [{ "url": "https://..." }, ...]
                
                // Pick a random video
                const randomVideo = videos[Math.floor(Math.random() * videos.length)].url;

                // Send message with video
                const allThreads = global.db.allThreadData.map(t => t.threadID);
                for (const threadID of allThreads) {
                    api.sendMessage({
                        body: note.message,
                        attachment: await global.utils.getStreamFromURL(randomVideo)
                    }, threadID);
                }
            } catch (err) {
                console.error("Error sending auto message:", err);
            }
        }

        // Schedule next check
        const nextMinute = moment().add(1, "minute").startOf("minute");
        const delay = nextMinute.diff(moment());
        setTimeout(sendAutoMessage, delay);
    };

    sendAutoMessage();
};

module.exports.onStart = () => {};
